import{_ as h}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as r,a as s,b as t,e as d,f as a,d as n,w as l,r as k,o as p}from"./app-BnAZYMcT.js";const g={};function c(o,i){const e=k("RouteLink");return p(),r("div",null,[i[9]||(i[9]=s("h1",{id:"設定-mariadb-10-6",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#設定-mariadb-10-6"},[s("span",null,"設定 MariaDB 10.6")])],-1)),i[10]||(i[10]=s("h2",{id:"前言",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#前言"},[s("span",null,"前言")])],-1)),s("p",null,[i[2]||(i[2]=a("本文是關於 MariaDB 的一些常用設定，",-1)),i[3]||(i[3]=s("br",null,null,-1)),i[4]||(i[4]=a(" 是以 Ubuntu 環境下為基準，",-1)),i[5]||(i[5]=s("br",null,null,-1)),i[6]||(i[6]=a(" 如果還不會安裝的可以先去看這篇",-1)),i[7]||(i[7]=s("br",null,null,-1)),n(e,{to:"/posts/2022-08-13-install-ubuntu-mariadb/"},{default:l(()=>i[0]||(i[0]=[a("在 Ubuntu 安裝 MariaDB 資料庫",-1)])),_:1,__:[0]}),i[8]||(i[8]=s("br",null,null,-1)),n(e,{to:"/posts/2022-09-02-install-windows-mariadb/"},{default:l(()=>i[1]||(i[1]=[a("在 Windows 安裝 MariaDB 資料庫",-1)])),_:1,__:[1]})]),t(" more "),i[11]||(i[11]=d(`<h2 id="路徑" tabindex="-1"><a class="header-anchor" href="#路徑"><span>路徑</span></a></h2><p>Ubuntu 安裝 MariaDB 預設的設定檔案路徑為 <code>/etc/mysql/my.cnf</code></p><h2 id="常用設定參考" tabindex="-1"><a class="header-anchor" href="#常用設定參考"><span>常用設定參考</span></a></h2><p>以下是參考官方文件同時記錄一些自己有使用過的設定，<br> 實際設定還是要根據使用者的需求調整。</p><h2 id="設定區塊-mysqld" tabindex="-1"><a class="header-anchor" href="#設定區塊-mysqld"><span>設定區塊 [mysqld]</span></a></h2><h3 id="設定-mysql-資料庫的資料的存放目錄-必須是-data" tabindex="-1"><a class="header-anchor" href="#設定-mysql-資料庫的資料的存放目錄-必須是-data"><span>設定 mysql 資料庫的資料的存放目錄，必須是 data</span></a></h3><p>預設值 <code>/var/lib/mysql</code></p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">datadir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> /var/lib/mysql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="mysql-服務端預設監聽-listen-on-的-tcp-ip-埠" tabindex="-1"><a class="header-anchor" href="#mysql-服務端預設監聽-listen-on-的-tcp-ip-埠"><span>mysql 服務端預設監聽(listen on)的 TCP/IP 埠</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 3306</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="伺服器使用的預設編碼" tabindex="-1"><a class="header-anchor" href="#伺服器使用的預設編碼"><span>伺服器使用的預設編碼</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">character_set_server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> utf8mb4</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">collation_server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> utf8mb4_unicode_ci</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="指定每次連線時執行的-sql" tabindex="-1"><a class="header-anchor" href="#指定每次連線時執行的-sql"><span>指定每次連線時執行的 SQL</span></a></h3><p>包含一個或多個 SQL 語句的字符串，用分號分隔，伺服器將為每個連接的客戶端執行這些語句。 如果其中一個語句存在語法錯誤，則客戶端將無法連接。</p><h3 id="表示初始化連線都設定為-utf8mb4-編碼" tabindex="-1"><a class="header-anchor" href="#表示初始化連線都設定為-utf8mb4-編碼"><span>表示初始化連線都設定為 utf8mb4 編碼</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">init_connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;SET NAMES utf8mb4&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="指定索引緩衝區的大小" tabindex="-1"><a class="header-anchor" href="#指定索引緩衝區的大小"><span>指定索引緩衝區的大小</span></a></h3><p>決定了索引處理的速度，尤其是索引讀的速度，建議設定成實體記憶體的 1/4，<br> 甚至實體記憶體的 30%-40%，如果設定太大，系統就會頻繁的換頁，降低系統效能</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">key_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 16M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="允許最大傳輸大小" tabindex="-1"><a class="header-anchor" href="#允許最大傳輸大小"><span>允許最大傳輸大小</span></a></h3><p>可以增大此值以便於 server 端接收更大的 SQL</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">max_allowed_packet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 4M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="分配設定的記憶體" tabindex="-1"><a class="header-anchor" href="#分配設定的記憶體"><span>分配設定的記憶體</span></a></h3><p>在每個 connection 第一次需要使用這個 buffer 的時候，一次性分配設定的記憶體</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">sort_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 512K</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="網路緩衝區大小" tabindex="-1"><a class="header-anchor" href="#網路緩衝區大小"><span>網路緩衝區大小</span></a></h3><p>不可超過 1M，且必須小於等於 max_allowed_packet</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">net_buffer_length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 8K</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="讀取緩衝區大小" tabindex="-1"><a class="header-anchor" href="#讀取緩衝區大小"><span>讀取緩衝區大小</span></a></h3><p>對資料表進行順序讀取的請求將分配一個讀取緩衝區，<br> 如果對資料表的順序讀取請求非常頻繁，<br> 可以通過增加該變數值以及記憶體緩衝區大小提高其效能。</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">read_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 256K</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="讀取隨機緩衝區大小" tabindex="-1"><a class="header-anchor" href="#讀取隨機緩衝區大小"><span>讀取隨機緩衝區大小</span></a></h4><p>引數用在 sort 查詢之後 ，以保證獲取以順序的方式獲取到查詢的資料。<br> 如果你有很多 order by 查詢語句，增長這值能夠提升效能</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">read_rnd_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 512K</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="repair-table" tabindex="-1"><a class="header-anchor" href="#repair-table"><span>REPAIR TABLE</span></a></h4><p>設定在 REPAIR TABLE，或者用 CREATE INDEX 建立索引或 ALTER TABLE 的過程中排序索引所分配的緩衝區大小。可設定範圍 4Bytes 至 4GB，預設為 8MB。</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">myisam_max_sort_file_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2G</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">myisam_sort_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 8M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="錯誤日誌輸出目的地" tabindex="-1"><a class="header-anchor" href="#錯誤日誌輸出目的地"><span>錯誤日誌輸出目的地</span></a></h4><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">log_error</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;mysql_error.log&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="設定-server-id" tabindex="-1"><a class="header-anchor" href="#設定-server-id"><span>設定 server-id</span></a></h4><p>如果不設定則 server-id 是根據伺服器 ip 地址後 2 位生成的，預設 0 或 1</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">server-id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="sql-mode" tabindex="-1"><a class="header-anchor" href="#sql-mode"><span>sql_mode</span></a></h4><p>設定 SQL 語句檢查</p><ul><li>NO_ZERO_IN_DATE &gt; 在嚴格模式下，不允許日期和月份為零</li><li>NO_ZERO_DATE &gt; mysql 資料庫不允許插入零日期，插入零日期會丟擲錯誤而不是警告。</li><li>NO_ENGINE_SUBSTITUTION &gt; 如果需要的儲存引擎被禁用或未編譯，那麼丟擲錯誤。</li></ul><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">sql_mode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> NO_ZERO_IN_DATE,NO_ZERO_DATE,NO_ENGINE_SUBSTITUTION</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="跳過-innodb-模式" tabindex="-1"><a class="header-anchor" href="#跳過-innodb-模式"><span>跳過 InnoDB 模式</span></a></h4><p>如果使用的是 InnoDB 資料庫引擎，請註釋以下內容</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">skip-innodb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="放置表空間資料的目錄" tabindex="-1"><a class="header-anchor" href="#放置表空間資料的目錄"><span>放置表空間資料的目錄，</span></a></h4><p>預設在 mysql 的資料目錄，設定到和 MySQL 安裝檔案不同的分割槽可以提高效能。</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_data_home_dir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> D:/WNMP/mariadb-10.6.7-winx64/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>指定表資料和索引儲存的空間，可以是一個或者多個檔案。<br> 最後一個資料檔案必須是自動擴充的，也只有最後一個檔案允許自動擴充。<br> 當空間用完後，自動擴充資料檔案就會自動增長（以 8MB 為單位）以容納額外的資料。<br> 例如：</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_data_file_path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> /disk1/ibdata1:900M</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">; /disk2/ibdata2:50M:autoextend</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>兩個資料檔案放在不同的磁碟上。<br> 資料首先放在 ibdata1 中，當達到 900M 以後，資料就放在 ibdata2 中。<br> 一旦達到 50MB，ibdata2 將以 8MB 為單位自動增長。<br> 如果磁碟滿了，需要在另外的磁碟上面增加一個資料檔案。</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_data_file_path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> ibdata1:10M:autoextend</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_log_group_home_dir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> D:/WNMP/mariadb-10.6.7-winx64/data</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_log_arch_dir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> D:/xampp/mysql/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="緩衝區記憶體大小" tabindex="-1"><a class="header-anchor" href="#緩衝區記憶體大小"><span>緩衝區記憶體大小</span></a></h3><p>這是 InnoDB 最重要的設定，對 InnoDB 效能有決定性的影響。<br> 預設的設定只有 8M，所以預設的資料庫設定下面 InnoDB 效能很差。<br> 在只有 InnoDB 儲存引擎的資料庫伺服器上面，可以設定 60-80%的記憶體。<br> 更精確一點，在記憶體容量允許的情況下面設定比 InnoDB tablespaces 大 10%的記憶體大小。</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_buffer_pool_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 8165M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="事務日誌檔案大小" tabindex="-1"><a class="header-anchor" href="#事務日誌檔案大小"><span>事務日誌檔案大小</span></a></h3><p>該引數決定了 recovery speed。太大的話 recovery 就會比較慢，太小了影響查詢效能，一般取 256M 可以兼顧效能和 recovery 的速度</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_log_file_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 256M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="事務日誌緩衝大小" tabindex="-1"><a class="header-anchor" href="#事務日誌緩衝大小"><span>事務日誌緩衝大小</span></a></h3><p>確保有足夠大的日誌緩衝區來儲存髒資料在被寫入到日誌檔案之前</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_log_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 8M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="事務日誌寫入策略" tabindex="-1"><a class="header-anchor" href="#事務日誌寫入策略"><span>事務日誌寫入策略</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_flush_log_at_trx_commit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>0：log buffer 將每秒一次地寫入 log file 中，並且 log file 的 flush(刷到磁碟)操作同時進行。該模式下在事務提交的時候，不會主動觸發寫入磁碟的操作。</li></ul><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_flush_log_at_trx_commit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>1：每次事務提交時 MySQL 都會把 log buffer 的資料寫入 log file，並且 flush(刷到磁碟)中去，該模式為系統預設。</li></ul><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_flush_log_at_trx_commit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>2：每次事務提交時 MySQL 都會把 log buffer 的資料寫入 log file，但是 flush(刷到磁碟)操作並不會同時進行。該模式下，MySQL 會每秒執行一次 flush(刷到磁碟)操作。</li></ul><h3 id="innodb-等待最長時間" tabindex="-1"><a class="header-anchor" href="#innodb-等待最長時間"><span>InnoDB 等待最長時間</span></a></h3><p>參數單位為秒</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_lock_wait_timeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 50</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="指定所有-innodb-資料表空間的頁面大小" tabindex="-1"><a class="header-anchor" href="#指定所有-innodb-資料表空間的頁面大小"><span>指定所有 InnoDB 資料表空間的頁面大小</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_page_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 32K</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="大小寫敏感" tabindex="-1"><a class="header-anchor" href="#大小寫敏感"><span>大小寫敏感</span></a></h3><h4 id="表名存儲為給定的大小和比較是區分大小寫的" tabindex="-1"><a class="header-anchor" href="#表名存儲為給定的大小和比較是區分大小寫的"><span>表名存儲為給定的大小和比較是區分大小寫的</span></a></h4><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">lower_case_table_names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="表名存儲在磁盤是小寫的-但是比較的時候是不區分大小寫" tabindex="-1"><a class="header-anchor" href="#表名存儲在磁盤是小寫的-但是比較的時候是不區分大小寫"><span>表名存儲在磁盤是小寫的，但是比較的時候是不區分大小寫</span></a></h4><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">lower_case_table_names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="表名存儲為給定的大小寫但是比較的時候是小寫的" tabindex="-1"><a class="header-anchor" href="#表名存儲為給定的大小寫但是比較的時候是小寫的"><span>表名存儲為給定的大小寫但是比較的時候是小寫的</span></a></h4><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">lower_case_table_names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="設定區塊-client" tabindex="-1"><a class="header-anchor" href="#設定區塊-client"><span>設定區塊 [client]</span></a></h2><p><a href="https://mariadb.com/kb/en/clients-utilities/" target="_blank" rel="noopener noreferrer">Clients &amp; Utilities</a></p><h3 id="連接到資料庫時使用的密碼。" tabindex="-1"><a class="header-anchor" href="#連接到資料庫時使用的密碼。"><span>連接到資料庫時使用的密碼。</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> your_password</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="用於連接的-tcp-ip-端口號。" tabindex="-1"><a class="header-anchor" href="#用於連接的-tcp-ip-端口號。"><span>用於連接的 TCP/IP 端口號。</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> port_num</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="資料庫的外掛目錄。" tabindex="-1"><a class="header-anchor" href="#資料庫的外掛目錄。"><span>資料庫的外掛目錄。</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">plugin-dir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> /path/to/plugin/directory</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="設定區塊-mysqldump" tabindex="-1"><a class="header-anchor" href="#設定區塊-mysqldump"><span>設定區塊 [mysqldump]</span></a></h2><h3 id="修改資料輸入上限" tabindex="-1"><a class="header-anchor" href="#修改資料輸入上限"><span>修改資料輸入上限</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">max_allowed_packet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 16M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="設定區塊-isamchk" tabindex="-1"><a class="header-anchor" href="#設定區塊-isamchk"><span>設定區塊 [isamchk]</span></a></h2><h3 id="指定索引緩衝區的大小-1" tabindex="-1"><a class="header-anchor" href="#指定索引緩衝區的大小-1"><span>指定索引緩衝區的大小</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">key_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 20M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">sort_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 20M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">read_buffer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">write_buffer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="設定區塊-myisamchk" tabindex="-1"><a class="header-anchor" href="#設定區塊-myisamchk"><span>設定區塊 [myisamchk]</span></a></h2><h3 id="指定索引緩衝區的大小-2" tabindex="-1"><a class="header-anchor" href="#指定索引緩衝區的大小-2"><span>指定索引緩衝區的大小</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">key_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 20M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">sort_buffer_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 20M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">read_buffer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">write_buffer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="參考資料" tabindex="-1"><a class="header-anchor" href="#參考資料"><span>參考資料</span></a></h2><p><a href="https://mariadb.com/kb/en/configuring-mariadb-with-option-files/" target="_blank" rel="noopener noreferrer">Configuring MariaDB with Option Files</a></p>`,103))])}const m=h(g,[["render",c]]),A=JSON.parse('{"path":"/posts/2022-08-24-config-mariadb-10.6/","title":"設定 MariaDB 10.6","lang":"zh-TW","frontmatter":{"title":"設定 MariaDB 10.6","description":"設定 MariaDB 10.6","date":"2022-08-24T00:00:00.000Z","category":"資料庫","tag":["MariaDB","MariaDB 10.6"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"設定 MariaDB 10.6\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-08-24T00:00:00.000Z\\",\\"dateModified\\":\\"2023-08-27T12:56:09.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Pamis Wang\\",\\"url\\":\\"https://pamis.dev\\",\\"email\\":\\"pamis.wang@gmail.com\\"}]}"],["meta",{"property":"og:url","content":"https://pamis.dev/posts/2022-08-24-config-mariadb-10.6/"}],["meta",{"property":"og:site_name","content":"Pamis Blog"}],["meta",{"property":"og:title","content":"設定 MariaDB 10.6"}],["meta",{"property":"og:description","content":"設定 MariaDB 10.6"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-TW"}],["meta",{"property":"og:updated_time","content":"2023-08-27T12:56:09.000Z"}],["meta",{"property":"article:tag","content":"MariaDB 10.6"}],["meta",{"property":"article:tag","content":"MariaDB"}],["meta",{"property":"article:published_time","content":"2022-08-24T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-08-27T12:56:09.000Z"}]]},"git":{"createdTime":1689521396000,"updatedTime":1693140969000,"contributors":[{"name":"pamis","username":"pamis","email":"pamis1116@gmail.com","commits":6,"url":"https://github.com/pamis"}]},"readingTime":{"minutes":5.56,"words":1668},"filePathRelative":"posts/2022-08-24-config-mariadb-10.6/index.md","excerpt":"\\n<h2>前言</h2>\\n<p>本文是關於 MariaDB 的一些常用設定，<br>\\n是以 Ubuntu 環境下為基準，<br>\\n如果還不會安裝的可以先去看這篇<br>\\n<a href=\\"/posts/2022-08-13-install-ubuntu-mariadb/\\" target=\\"_blank\\">在 Ubuntu 安裝 MariaDB 資料庫</a><br>\\n<a href=\\"/posts/2022-09-02-install-windows-mariadb/\\" target=\\"_blank\\">在 Windows 安裝 MariaDB 資料庫</a></p>\\n"}');export{m as comp,A as data};
