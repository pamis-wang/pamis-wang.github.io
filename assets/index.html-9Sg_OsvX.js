import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,e as a,o as n}from"./app-DcPmYxSv.js";const l={};function t(r,s){return n(),e("div",null,s[0]||(s[0]=[a(`<h1 id="確認條件" tabindex="-1"><a class="header-anchor" href="#確認條件"><span>確認條件</span></a></h1><h2 id="確認-php-支持的-pdo-pgsql-版本" tabindex="-1"><a class="header-anchor" href="#確認-php-支持的-pdo-pgsql-版本"><span>確認 PHP 支持的 <code>pdo_pgsql</code> 版本</span></a></h2><p>通過輸出 phpinfo() 函數，查看 PHP 對應的 pdo_pgsql 的版本，<br> 建議下載的 PostgreSQL 與 pdo_pgsql 版本不要相差太多<br> ![[pdo_pgsql_version.jpg]]</p><p>PostgreSQL 版本大於 10 的話，則 pdo_pgsql 版本也必須大於 10 。<br> scram-sha-256 是 PostgreSQL 10 中新增的基於 SASL 的認證方式，是 PostgreSQL 目前提供的最安全的認證方式。使用 scram-sha-256 認證方式不支持舊版本的客戶端庫。如果使用 PostgreSQL 10 以前的客戶端庫連接數據庫，會有如下錯誤：<br> SCRAM authentication requires libpq version 10 or above</p><h1 id="安裝-postgresql" tabindex="-1"><a class="header-anchor" href="#安裝-postgresql"><span>安裝 PostgreSQL</span></a></h1><h2 id="安裝指令" tabindex="-1"><a class="header-anchor" href="#安裝指令"><span>安裝指令</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 建立軟體庫設定文件：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;echo &quot;deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main&quot; &gt; /etc/apt/sources.list.d/pgdg.list&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匯入軟體庫簽名密鑰：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --quiet</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -O</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://www.postgresql.org/media/keys/ACCC4CF8.asc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt-key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 更新軟體列表：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 安裝最新版本的PostgreSQL</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> postgresql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 可供安裝特定版本的PostgreSQL</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt-cache</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pkgnames</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> postgresql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 安裝特定版本的PostgreSQL</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> postgresql-14</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>實際指令以及對應版本可參考<a href="https://www.postgresql.org/download/linux/ubuntu/" target="_blank" rel="noopener noreferrer">PostgreSQL官方安裝教學</a></p><h2 id="測試安裝是否成功" tabindex="-1"><a class="header-anchor" href="#測試安裝是否成功"><span>測試安裝是否成功</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> psql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --version</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="安裝-pgadmin-4-可選" tabindex="-1"><a class="header-anchor" href="#安裝-pgadmin-4-可選"><span>安裝 pgAdmin 4 (可選)</span></a></h1><p>[[install_ubuntu_pgAdmin4]]</p><h1 id="觀念預備" tabindex="-1"><a class="header-anchor" href="#觀念預備"><span>觀念預備</span></a></h1><p>[[guide_PostgreSQL]]</p><h1 id="初次設定" tabindex="-1"><a class="header-anchor" href="#初次設定"><span>初次設定</span></a></h1><h2 id="以超級使用者身分使用預設的角色-postgres" tabindex="-1"><a class="header-anchor" href="#以超級使用者身分使用預設的角色-postgres"><span>以超級使用者身分使用預設的角色 postgres</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> su</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> postgres</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>通常<code>postgres</code>用戶只會在本地被使用。</p><h2 id="進入psql-互動式終端機" tabindex="-1"><a class="header-anchor" href="#進入psql-互動式終端機"><span>進入psql 互動式終端機</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">psql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="變更管理員密碼" tabindex="-1"><a class="header-anchor" href="#變更管理員密碼"><span>變更管理員密碼</span></a></h2><p>確認該版本的加密方式</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SHOW password_encryption;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>舊版為<code>md5</code>，新版為<code>scram-sha-256</code>，如果要變更設定可到<code>/etc/postgresql/14/main/postgresql.conf</code>調整<code>password_encryption</code><br><a href="https://docs.postgresql.tw/server-administration/server-configuration/connections-and-authentication" target="_blank" rel="noopener noreferrer">20.3. 連線與認證</a></p><p>初始不用密碼就可以進入伺服器了，所以建議先改個密碼。</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> USER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> postgres </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">PASSWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;password&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><a href="https://docs.postgresql.tw/reference/sql-commands/alter-user" target="_blank" rel="noopener noreferrer">ALTER USER — 變更資料庫角色屬性</a><br> 以普通使用者連線伺服器</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">psql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -U</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> postgres</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果看到下圖就是成功了<br> ![[postgres_password.jpg]]</p><h2 id="建立角色" tabindex="-1"><a class="header-anchor" href="#建立角色"><span>建立角色</span></a></h2><h3 id="進入psql-互動式終端機-1" tabindex="-1"><a class="header-anchor" href="#進入psql-互動式終端機-1"><span>進入psql 互動式終端機</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">psql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="建立可登入的用戶" tabindex="-1"><a class="header-anchor" href="#建立可登入的用戶"><span>建立可登入的用戶</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"># 使用別名並設定密碼</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> USER</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> name</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> WITH</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> PASSWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;********&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"># 或使用新增角色指令並加入 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">LOGIN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 參數</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> ROLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> name</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> WITH</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> LOGIN</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> PASSWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;********&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>CREATE USER 現在是 CREATE ROLE 的別名指令。唯一的區別是當命令為 CREATE USER 時，預設情況下是具有 LOGIN 權限的，而當命令為 CREATE ROLE 時則預設為 NOLOGIN。</p><p>具有 LOGIN 屬性的角色可以被認為是一個使用者。沒有此屬性的角色對於管理資料庫權限很有用，但不是一般認知上的使用者。</p><p><a href="https://docs.postgresql.tw/reference/sql-commands/create-role" target="_blank" rel="noopener noreferrer">CREATE ROLE — 定義一個新的資料庫角色</a><br><a href="https://docs.postgresql.tw/reference/sql-commands/create-user" target="_blank" rel="noopener noreferrer">CREATE USER — 定義一個新的資料庫角色</a></p><h3 id="設定用戶管理資料庫權限" tabindex="-1"><a class="header-anchor" href="#設定用戶管理資料庫權限"><span>設定用戶管理資料庫權限</span></a></h3><p>賦予角色建立其他角色和新資料庫的能力</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> USER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user CREATEROLE CREATEDB;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><a href="https://docs.postgresql.tw/reference/sql-commands/alter-user" target="_blank" rel="noopener noreferrer">ALTER USER — 變更資料庫角色屬性</a><br><a href="https://docs.postgresql.tw/reference/sql-commands/alter-role" target="_blank" rel="noopener noreferrer">ALTER ROLE — 變更資料庫角色</a></p><h3 id="列出用戶列表檢查是否修改成功" tabindex="-1"><a class="header-anchor" href="#列出用戶列表檢查是否修改成功"><span>列出用戶列表檢查是否修改成功</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">postgres-# \\du+</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>之後用 pgAdmin管理工具來設定其他使用者權限比較方便</p><h2 id="設定遠端連線" tabindex="-1"><a class="header-anchor" href="#設定遠端連線"><span>設定遠端連線</span></a></h2><h3 id="修改設定文件" tabindex="-1"><a class="header-anchor" href="#修改設定文件"><span>修改設定文件</span></a></h3><p>預設情況下，PostgreSQL 伺服器只監聽本機位址：127.0.0.1。<br> 為了允許遠端連線<br> 打開設定文件<code>/etc/postgresql/14/main/postgresql.conf</code><br> 並且在<code>CONNECTIONS AND AUTHENTICATION</code>一節添加 <code>listen_addresses = &#39;*&#39;</code>後存檔。</p><h3 id="設定伺服器接受遠端連線" tabindex="-1"><a class="header-anchor" href="#設定伺服器接受遠端連線"><span>設定伺服器接受遠端連線</span></a></h3><p>開啟 <code>/etc/postgresql/14/main/pg_hba.conf</code> 設定允許的連接方式</p><p>例如直接全開並使用 scram-sha-256 加密方式做驗證</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span># TYPE  DATABASE    USER       ADDRESS             METHOD</span></span>
<span class="line"><span>host    all         all        0.0.0.0/0           scram-sha-256</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>實際在正式環境詳細設定請參照官方的文件<br><a href="https://docs.postgresql.tw/server-administration/client-authentication/the-pg_hba.conf-file" target="_blank" rel="noopener noreferrer">21.1. 設定檔：pg_hba.conf</a></p><h3 id="重新啟動服務" tabindex="-1"><a class="header-anchor" href="#重新啟動服務"><span>重新啟動服務</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> postgresql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="系統可用指令" tabindex="-1"><a class="header-anchor" href="#系統可用指令"><span>系統可用指令</span></a></h1><h2 id="查看執行狀態" tabindex="-1"><a class="header-anchor" href="#查看執行狀態"><span>查看執行狀態</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> postgresql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="查看資料庫版本" tabindex="-1"><a class="header-anchor" href="#查看資料庫版本"><span>查看資料庫版本</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> psql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --version</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="以超級使用者身分使用-postgres" tabindex="-1"><a class="header-anchor" href="#以超級使用者身分使用-postgres"><span>以超級使用者身分使用 postgres</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> su</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> postgres</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用後帳號名稱會變postgres，表示成功進入伺服器</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">postgres@computer-name:~$</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="psql-—-postgresql-互動式終端機" tabindex="-1"><a class="header-anchor" href="#psql-—-postgresql-互動式終端機"><span>psql — PostgreSQL 互動式終端機</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">postgres@computer-name:~$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> psql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="資料庫可用指令" tabindex="-1"><a class="header-anchor" href="#資料庫可用指令"><span>資料庫可用指令</span></a></h1><h2 id="顯示伺服器的版本號碼" tabindex="-1"><a class="header-anchor" href="#顯示伺服器的版本號碼"><span>顯示伺服器的版本號碼</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SHOW SERVER_ENCODING;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><a href="https://docs.postgresql.tw/reference/sql-commands/show" target="_blank" rel="noopener noreferrer">SHOW — 顯示執行時期參數的值</a></p><h2 id="查看用戶列表" tabindex="-1"><a class="header-anchor" href="#查看用戶列表"><span>查看用戶列表</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">postgres-# \\du+</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="查看資料庫列表" tabindex="-1"><a class="header-anchor" href="#查看資料庫列表"><span>查看資料庫列表</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">postgres-# \\l+</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="離開-psql-終端" tabindex="-1"><a class="header-anchor" href="#離開-psql-終端"><span>離開 psql 終端</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">exit;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="參考資料" tabindex="-1"><a class="header-anchor" href="#參考資料"><span>參考資料</span></a></h1><p><a href="https://www.postgresql.org/download/linux/ubuntu/" target="_blank" rel="noopener noreferrer">PostgreSQL官方安裝教學</a><br><a href="https://www.pgadmin.org/download/pgadmin-4-apt/" target="_blank" rel="noopener noreferrer">pgAdmin官方安裝教學</a><br><a href="https://www.postgresql.org/docs/14/index.html" target="_blank" rel="noopener noreferrer">PostgreSQL 14.7 Documentation</a><br><a href="https://docs.postgresql.tw/" target="_blank" rel="noopener noreferrer">PostgreSQL正體中文使用手冊</a><br><a href="https://learnku.com/articles/67688" target="_blank" rel="noopener noreferrer">https://learnku.com/articles/67688</a><br><a href="https://zhuanlan.zhihu.com/p/580030679" target="_blank" rel="noopener noreferrer">Ubuntu-22.04安装Postgresql</a></p><h1 id="常見問題" tabindex="-1"><a class="header-anchor" href="#常見問題"><span>常見問題</span></a></h1><p><a href="https://dba.stackexchange.com/questions/40335/postgresql-cannot-change-directory-to-root" target="_blank" rel="noopener noreferrer">could not change directory to &quot;/root&quot;: Permission denied</a></p>`,79)]))}const p=i(l,[["render",t]]),o=JSON.parse('{"path":"/posts/2023-04-18-install-ubuntu-postgresql/","title":"在 Ubuntu 安裝 PostgreSQL 資料庫","lang":"zh-TW","frontmatter":{"title":"在 Ubuntu 安裝 PostgreSQL 資料庫","date":"2023-04-18T00:00:00.000Z","category":"資料庫","tag":["PostgreSQL","PostgreSQL 14","Ubuntu","Ubuntu 22.04"],"description":"確認條件 確認 PHP 支持的 pdo_pgsql 版本 通過輸出 phpinfo() 函數，查看 PHP 對應的 pdo_pgsql 的版本， 建議下載的 PostgreSQL 與 pdo_pgsql 版本不要相差太多 ![[pdo_pgsql_version.jpg]] PostgreSQL 版本大於 10 的話，則 pdo_pgsql 版本也必須...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"在 Ubuntu 安裝 PostgreSQL 資料庫\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-04-18T00:00:00.000Z\\",\\"dateModified\\":\\"2023-07-17T17:48:08.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Pamis Wang\\",\\"url\\":\\"https://pamis.dev\\",\\"email\\":\\"pamis.wang@gmail.com\\"}]}"],["meta",{"property":"og:url","content":"https://pamis.dev/posts/2023-04-18-install-ubuntu-postgresql/"}],["meta",{"property":"og:site_name","content":"Pamis Blog"}],["meta",{"property":"og:title","content":"在 Ubuntu 安裝 PostgreSQL 資料庫"}],["meta",{"property":"og:description","content":"確認條件 確認 PHP 支持的 pdo_pgsql 版本 通過輸出 phpinfo() 函數，查看 PHP 對應的 pdo_pgsql 的版本， 建議下載的 PostgreSQL 與 pdo_pgsql 版本不要相差太多 ![[pdo_pgsql_version.jpg]] PostgreSQL 版本大於 10 的話，則 pdo_pgsql 版本也必須..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-TW"}],["meta",{"property":"og:updated_time","content":"2023-07-17T17:48:08.000Z"}],["meta",{"property":"article:tag","content":"Ubuntu 22.04"}],["meta",{"property":"article:tag","content":"Ubuntu"}],["meta",{"property":"article:tag","content":"PostgreSQL 14"}],["meta",{"property":"article:tag","content":"PostgreSQL"}],["meta",{"property":"article:published_time","content":"2023-04-18T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-07-17T17:48:08.000Z"}]]},"git":{"createdTime":1689521396000,"updatedTime":1689616088000,"contributors":[{"name":"pamis","username":"pamis","email":"pamis1116@gmail.com","commits":3,"url":"https://github.com/pamis"}]},"readingTime":{"minutes":3.83,"words":1150},"filePathRelative":"posts/2023-04-18-install-ubuntu-postgresql/index.md","excerpt":"\\n<h2>確認 PHP 支持的&nbsp;<code>pdo_pgsql</code>&nbsp;版本</h2>\\n<p>通過輸出 phpinfo() 函數，查看 PHP 對應的 pdo_pgsql 的版本，<br>\\n建議下載的 PostgreSQL 與 pdo_pgsql 版本不要相差太多<br>\\n![[pdo_pgsql_version.jpg]]</p>\\n<p>PostgreSQL 版本大於 10 的話，則 pdo_pgsql 版本也必須大於 10 。<br>\\nscram-sha-256 是 PostgreSQL 10 中新增的基於 SASL 的認證方式，是 PostgreSQL 目前提供的最安全的認證方式。使用 scram-sha-256 認證方式不支持舊版本的客戶端庫。如果使用 PostgreSQL 10 以前的客戶端庫連接數據庫，會有如下錯誤：<br>\\nSCRAM authentication requires libpq version 10 or above</p>","autoDesc":true}');export{p as comp,o as data};
