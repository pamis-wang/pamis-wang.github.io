import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as h,a as i,b as r,e as d,f as a,d as n,w as t,r as p,o as k}from"./app-DcPmYxSv.js";const o="/assets/meme-01-DgHwODep.webp",g={};function c(u,s){const e=p("RouteLink");return k(),h("div",null,[s[8]||(s[8]=i("h2",{id:"前言",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#前言"},[i("span",null,"前言")])],-1)),s[9]||(s[9]=i("p",null,[a("每次登入 Linux 主機都要打密碼，"),i("br"),a(" 常常手殘打錯，所以又要來當懶人了。")],-1)),s[10]||(s[10]=i("p",null,[a("透過設定 SSH 金鑰使登入 Linux 主機不需要打密碼，"),i("br"),a(" 本篇教學以 Windows 作業系統連線 Linux 的情境為例子。")],-1)),s[11]||(s[11]=i("figure",null,[i("img",{src:o,alt:"真的會很憤怒",tabindex:"0",loading:"lazy"}),i("figcaption",null,"真的會很憤怒")],-1)),r(" more "),s[12]||(s[12]=i("h2",{id:"事前準備",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#事前準備"},[i("span",null,"事前準備")])],-1)),i("p",null,[s[1]||(s[1]=a("要確定 Linux 主機有安裝 SSH 並且開通對應的 Port",-1)),s[2]||(s[2]=i("br",null,null,-1)),s[3]||(s[3]=a(" 一般預設都是 22 Port",-1)),s[4]||(s[4]=i("br",null,null,-1)),s[5]||(s[5]=a(" 不會安裝的可以參考文件 ",-1)),n(e,{to:"/posts/2022-08-19-install-ubuntu-22.04/"},{default:t(()=>s[0]||(s[0]=[a("使用 VMware 虛擬機建置 Ubuntu 作業系統",-1)])),_:1,__:[0]})]),s[13]||(s[13]=i("h2",{id:"加入-ssh-金鑰",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#加入-ssh-金鑰"},[i("span",null,"加入 SSH 金鑰")])],-1)),s[14]||(s[14]=i("h3",{id:"金鑰建立與設定",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#金鑰建立與設定"},[i("span",null,"金鑰建立與設定")])],-1)),i("p",null,[s[7]||(s[7]=a("參考文件 ",-1)),n(e,{to:"/posts/2022-12-15-setting-ssh-key/"},{default:t(()=>s[6]||(s[6]=[a("SSH 金鑰建立與設定",-1)])),_:1,__:[6]})]),s[15]||(s[15]=d(`<h3 id="建立金鑰列表檔案" tabindex="-1"><a class="header-anchor" href="#建立金鑰列表檔案"><span>建立金鑰列表檔案</span></a></h3><p>在想要連線的 Linux 主機內建立 authorized_keys 檔案</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .ssh</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~/.ssh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nano</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> authorized_keys</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="填寫金鑰列表檔案" tabindex="-1"><a class="header-anchor" href="#填寫金鑰列表檔案"><span>填寫金鑰列表檔案</span></a></h3><p>將 Windows 產生的 公鑰複製貼上到 authorized_keys 檔案內</p><h3 id="設定金鑰列表檔案權限" tabindex="-1"><a class="header-anchor" href="#設定金鑰列表檔案權限"><span>設定金鑰列表檔案權限</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~/.ssh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 700</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~/.ssh/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 600</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~/.ssh/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="進行連線" tabindex="-1"><a class="header-anchor" href="#進行連線"><span>進行連線</span></a></h2><h3 id="使用命令提示字元" tabindex="-1"><a class="header-anchor" href="#使用命令提示字元"><span>使用命令提示字元</span></a></h3><p>使用 ssh 進行連線指令<br> 如有多個私鑰 -i 參數指定要使用的私鑰檔：<br> 如果不是使用 SSH 預設的 22 port，可使用 -p 參數指定 port：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ssh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pamis@xxx.xxx.xxx.xxx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> C:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\U</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">sers</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">amis</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ssh</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">d_rsa_ubuntu</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="使用-visual-studio-code" tabindex="-1"><a class="header-anchor" href="#使用-visual-studio-code"><span>使用 Visual Studio Code</span></a></h3><h3 id="設定連線設定檔案" tabindex="-1"><a class="header-anchor" href="#設定連線設定檔案"><span>設定連線設定檔案</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> LabServer</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              #填寫別名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	HostName</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xxx.xxx.xxx.xxx</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                #主機名稱或是ip位置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	Port</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                    #如果有指定的Port號</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	User</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> username</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           #登入的使用者名稱</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    PreferredAuthentications</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> publickey</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      #首選驗證方式</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    IdentityFile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~/.ssh/id_rsa_ubuntu</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       #私鑰路徑</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>實際可參考</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 我的主機</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	HostName</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 192.168.100.100</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	User</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pamis</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	PreferredAuthentications</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> publickey</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	IdentityFile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~/.ssh/id_rsa_ubuntu</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="使用-putty" tabindex="-1"><a class="header-anchor" href="#使用-putty"><span>使用 Putty</span></a></h2><p>由於 Putty 只接受 ppk 格式的私鑰<br> 所以需要先匯入現有的私鑰並轉換 ppk 格式</p><h3 id="匯入到-puttygen" tabindex="-1"><a class="header-anchor" href="#匯入到-puttygen"><span>匯入到 PuTTYgen</span></a></h3><ul><li>點選 Load</li><li>選擇所有檔案並匯入私鑰檔案</li><li>點選 Save private key 另存 .ppk 格式</li></ul><h3 id="設定-putty-連線" tabindex="-1"><a class="header-anchor" href="#設定-putty-連線"><span>設定 Putty 連線</span></a></h3><ul><li>用戶名稱：Connection &gt; Data &gt; Auto-login username</li><li>私鑰檔案：Connection &gt; SSH &gt; Auth</li><li>記得存檔</li></ul><h2 id="root-登入" tabindex="-1"><a class="header-anchor" href="#root-登入"><span>root 登入</span></a></h2><h3 id="建立資料夾與檔案" tabindex="-1"><a class="header-anchor" href="#建立資料夾與檔案"><span>建立資料夾與檔案</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /root</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .ssh</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .ssh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nano</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> authorized_keys</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="加入公鑰字串" tabindex="-1"><a class="header-anchor" href="#加入公鑰字串"><span>加入公鑰字串</span></a></h3><p><a href="#%E5%A1%AB%E5%AF%AB%E9%87%91%E9%91%B0%E5%88%97%E8%A1%A8%E6%AA%94%E6%A1%88">填寫金鑰列表檔案</a></p><h3 id="修改-ssh-的設定" tabindex="-1"><a class="header-anchor" href="#修改-ssh-的設定"><span>修改 ssh 的設定</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nano</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/ssh/sshd_config</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="開放-root-登入" tabindex="-1"><a class="header-anchor" href="#開放-root-登入"><span>開放 root 登入</span></a></h3><p>在下面加入一行</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>#PermitRootLogin prohibit-password</span></span>
<span class="line"><span>PermitRootLogin yes</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="更改完存檔後記得重啟服務" tabindex="-1"><a class="header-anchor" href="#更改完存檔後記得重啟服務"><span>更改完存檔後記得重啟服務</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="重啟錯誤處理" tabindex="-1"><a class="header-anchor" href="#重啟錯誤處理"><span>重啟錯誤處理</span></a></h3><p>如果重啟失敗出現如下訊息</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>Failed to start sshd.service: Unit sshd.service not found.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>則要先將系統與服務管理器啟用 SSH 服務</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ssh.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,39))])}const y=l(g,[["render",c]]),A=JSON.parse('{"path":"/posts/2022-12-16-setting-ssh-key-to-linux/","title":"透過 SSH 金鑰登入 Linux 主機","lang":"zh-TW","frontmatter":{"title":"透過 SSH 金鑰登入 Linux 主機","date":"2022-12-16T00:00:00.000Z","category":"作業系統","tag":["SSH","Linux"],"description":"前言 每次登入 Linux 主機都要打密碼， 常常手殘打錯，所以又要來當懶人了。 透過設定 SSH 金鑰使登入 Linux 主機不需要打密碼， 本篇教學以 Windows 作業系統連線 Linux 的情境為例子。 真的會很憤怒","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"透過 SSH 金鑰登入 Linux 主機\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-12-16T00:00:00.000Z\\",\\"dateModified\\":\\"2024-12-29T11:50:27.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Pamis Wang\\",\\"url\\":\\"https://pamis.dev\\",\\"email\\":\\"pamis.wang@gmail.com\\"}]}"],["meta",{"property":"og:url","content":"https://pamis.dev/posts/2022-12-16-setting-ssh-key-to-linux/"}],["meta",{"property":"og:site_name","content":"Pamis Blog"}],["meta",{"property":"og:title","content":"透過 SSH 金鑰登入 Linux 主機"}],["meta",{"property":"og:description","content":"前言 每次登入 Linux 主機都要打密碼， 常常手殘打錯，所以又要來當懶人了。 透過設定 SSH 金鑰使登入 Linux 主機不需要打密碼， 本篇教學以 Windows 作業系統連線 Linux 的情境為例子。 真的會很憤怒"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-TW"}],["meta",{"property":"og:updated_time","content":"2024-12-29T11:50:27.000Z"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:tag","content":"SSH"}],["meta",{"property":"article:published_time","content":"2022-12-16T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-12-29T11:50:27.000Z"}]]},"git":{"createdTime":1689521396000,"updatedTime":1735473027000,"contributors":[{"name":"pamis","username":"pamis","email":"pamis1116@gmail.com","commits":4,"url":"https://github.com/pamis"},{"name":"EXMAIL\\\\pamis","username":"","email":"pamis@mail.tca.org.tw","commits":1},{"name":"Pamis Wang","username":"","email":"pamis1116@gmail.com","commits":2}]},"readingTime":{"minutes":2.12,"words":636},"filePathRelative":"posts/2022-12-16-setting-ssh-key-to-linux/index.md","excerpt":"<h2>前言</h2>\\n<p>每次登入 Linux 主機都要打密碼，<br>\\n常常手殘打錯，所以又要來當懶人了。</p>\\n<p>透過設定 SSH 金鑰使登入 Linux 主機不需要打密碼，<br>\\n本篇教學以 Windows 作業系統連線 Linux 的情境為例子。</p>\\n<figure><figcaption>真的會很憤怒</figcaption></figure>\\n","autoDesc":true}');export{y as comp,A as data};
