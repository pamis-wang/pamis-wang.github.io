import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as i,e as t,d as l,w as r,r as p,o as h,f as k}from"./app-DcPmYxSv.js";const d="/assets/dot_net_6_docker_3-cwJKu_mt.jpg",o={};function c(g,s){const a=p("RouteLink");return h(),n("div",null,[s[1]||(s[1]=i("h1",{id:"docker-安裝",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#docker-安裝"},[i("span",null,"Docker 安裝")])],-1)),i("p",null,[l(a,{to:"/posts/2022-12-20-install-ubuntu-docker/"},{default:r(()=>s[0]||(s[0]=[k("在 Ubuntu 上安裝 Docker",-1)])),_:1,__:[0]})]),s[2]||(s[2]=t('<h1 id="參考官方文件選定版本" tabindex="-1"><a class="header-anchor" href="#參考官方文件選定版本"><span>參考官方文件選定版本</span></a></h1><p><a href="https://github.com/dotnet/dotnet-docker" target="_blank" rel="noopener noreferrer">官方的 dotnet-docker github</a><br> 這裡非常重要！！！ 千萬不要選錯版本！！！<br><img src="'+d+`" alt="參考官方文件選定版本" loading="lazy"></p><h2 id="選定正確版本" tabindex="-1"><a class="header-anchor" href="#選定正確版本"><span>選定正確版本</span></a></h2><p>這裡有個方法幫助辨識選定正確的版本<br> 開啟 Visual Studio 2022 ，選擇要建置的專案類型後，勾選 Docker 選項<br> ![[dot_net_6_docker_4.jpg]]<br> 專案建立之後進去看 <code>Dockerfile</code> 的內容，可以看到使用的映像檔是 aspnet<br> ![[dot_net_6_docker_5.jpg]]</p><h1 id="取得-dockerfile" tabindex="-1"><a class="header-anchor" href="#取得-dockerfile"><span>取得 Dockerfile</span></a></h1><h2 id="到-dockerhub-取得官方提供的映像檔案" tabindex="-1"><a class="header-anchor" href="#到-dockerhub-取得官方提供的映像檔案"><span>到 dockerhub 取得官方提供的映像檔案</span></a></h2><p><a href="https://hub.docker.com/_/microsoft-dotnet-sdk" target="_blank" rel="noopener noreferrer">https://hub.docker.com/_/microsoft-dotnet-sdk</a></p><p>![[dot_net_6_docker_1.jpg]]</p><h2 id="選擇對應的版本" tabindex="-1"><a class="header-anchor" href="#選擇對應的版本"><span>選擇對應的版本</span></a></h2><p>本次安裝的是 .Net Core 6 所以選擇反白的選項<br> ![[dot_net_6_docker_2.jpg]]</p><h2 id="建立-dockerfile" tabindex="-1"><a class="header-anchor" href="#建立-dockerfile"><span>建立 Dockerfile</span></a></h2><p><a href="https://github.com/dotnet/dotnet-docker/blob/main/samples/aspnetapp/Dockerfile.ubuntu" target="_blank" rel="noopener noreferrer">參考官方的範例來改</a></p><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 建置編譯階段 Image, from dotnet/sdk, 並指定工作目錄為 /source</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mcr.microsoft.com/dotnet/sdk:6.0 </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">AS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> build</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /source</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># COPY 本機的所有檔案到 build image source 目錄下, 並執行套件還原指令, 此步驟需連網</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">COPY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> . .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dotnet restore</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 執行 dotnet build 指令</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dotnet build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 執行 dotnet 發佈指令, 並指定為 Release 版本</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dotnet publish -c release --no-restore -o /app</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 建置執行階段 Image, from dotnet/aspnet image, 並指定工作目錄為 /app</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mcr.microsoft.com/dotnet/aspnet:6.0 </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">AS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> base</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ENV</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> TZ=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Asia/Taipei&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /app</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># COPY 編譯階段已產生的發佈檔至 /app 下</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">COPY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> --from=build /app .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 透過 Kestrel 啟動專案服務</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ENTRYPOINT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;dotnet&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;test.dll&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="執行映像檔建立指令" tabindex="-1"><a class="header-anchor" href="#執行映像檔建立指令"><span>執行映像檔建立指令</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pamis/asp-net-core-6-api</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Dockerfile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="docker-compose" tabindex="-1"><a class="header-anchor" href="#docker-compose"><span>Docker Compose</span></a></h2><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># sudo docker compose up -d</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 使用 3.8 版的設定檔，通常新版本會有新的功能，並支援新的設定參數</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;3.8&#39;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">services</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  asp-net-core-6-api</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;pamis/asp-net-core-6-api:latest&#39;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    container_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">asp-net-core-6-api</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;8080:80&#39;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # Public HTTP Port</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;8081:443&#39;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # Public HTTPS Port</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">aspnet_app:/app</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">aspnet_https:/https</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  aspnet_app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;aspnet_app&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  aspnet_https</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;aspnet_https&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="參考資料" tabindex="-1"><a class="header-anchor" href="#參考資料"><span>參考資料</span></a></h1><p><a href="https://dotblogs.com.tw/supergary/2023/05/10/Net6_Container" target="_blank" rel="noopener noreferrer">使用 Docker 建立.NET 6 容器</a><br><a href="https://dotblogs.com.tw/fire/2022/10/27/225738" target="_blank" rel="noopener noreferrer">.NET Core 的 Dockerfile 指令詳解</a><br><a href="https://blog.darkthread.net/blog/aspnetcore-docker-with-cli/" target="_blank" rel="noopener noreferrer">ASP.NET Core Docker 單兵徒手基本教練</a></p>`,19))])}const A=e(o,[["render",c]]),b=JSON.parse('{"path":"/posts/2023-07-08-install-ubuntu-docker-aspnet-core-6/","title":"在 Ubuntu 使用 Docker 建構 ASP.NET Core 6 開發環境","lang":"zh-TW","frontmatter":{"title":"在 Ubuntu 使用 Docker 建構 ASP.NET Core 6 開發環境","date":"2023-07-08T00:00:00.000Z","category":"後端","tag":["ASP.NET Core","ASP.NET Core 6","Docker"],"description":"Docker 安裝 參考官方文件選定版本 官方的 dotnet-docker github 這裡非常重要！！！ 千萬不要選錯版本！！！ 參考官方文件選定版本 選定正確版本 這裡有個方法幫助辨識選定正確的版本 開啟 Visual Studio 2022 ，選擇要建置的專案類型後，勾選 Docker 選項 ![[dot_net_6_docker_4.jpg...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"在 Ubuntu 使用 Docker 建構 ASP.NET Core 6 開發環境\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-07-08T00:00:00.000Z\\",\\"dateModified\\":\\"2024-02-03T10:33:35.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Pamis Wang\\",\\"url\\":\\"https://pamis.dev\\",\\"email\\":\\"pamis.wang@gmail.com\\"}]}"],["meta",{"property":"og:url","content":"https://pamis.dev/posts/2023-07-08-install-ubuntu-docker-aspnet-core-6/"}],["meta",{"property":"og:site_name","content":"Pamis Blog"}],["meta",{"property":"og:title","content":"在 Ubuntu 使用 Docker 建構 ASP.NET Core 6 開發環境"}],["meta",{"property":"og:description","content":"Docker 安裝 參考官方文件選定版本 官方的 dotnet-docker github 這裡非常重要！！！ 千萬不要選錯版本！！！ 參考官方文件選定版本 選定正確版本 這裡有個方法幫助辨識選定正確的版本 開啟 Visual Studio 2022 ，選擇要建置的專案類型後，勾選 Docker 選項 ![[dot_net_6_docker_4.jpg..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-TW"}],["meta",{"property":"og:updated_time","content":"2024-02-03T10:33:35.000Z"}],["meta",{"property":"article:tag","content":"Docker"}],["meta",{"property":"article:tag","content":"ASP.NET Core 6"}],["meta",{"property":"article:tag","content":"ASP.NET Core"}],["meta",{"property":"article:published_time","content":"2023-07-08T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-02-03T10:33:35.000Z"}]]},"git":{"createdTime":1689521396000,"updatedTime":1706956415000,"contributors":[{"name":"pamis","username":"pamis","email":"pamis1116@gmail.com","commits":4,"url":"https://github.com/pamis"},{"name":"EXMAIL\\\\pamis","username":"","email":"pamis@mail.tca.org.tw","commits":1},{"name":"Pamis Wang","username":"","email":"pamis1116@gmail.com","commits":1}]},"readingTime":{"minutes":1.74,"words":522},"filePathRelative":"posts/2023-07-08-install-ubuntu-docker-aspnet-core-6/index.md","excerpt":"\\n<p><a href=\\"/posts/2022-12-20-install-ubuntu-docker/\\" target=\\"_blank\\">在 Ubuntu 上安裝 Docker</a></p>\\n<h1>參考官方文件選定版本</h1>\\n<p><a href=\\"https://github.com/dotnet/dotnet-docker\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">官方的 dotnet-docker github</a><br>\\n這裡非常重要！！！ 千萬不要選錯版本！！！<br>\\n</p>\\n<h2>選定正確版本</h2>\\n<p>這裡有個方法幫助辨識選定正確的版本<br>\\n開啟 Visual Studio 2022 ，選擇要建置的專案類型後，勾選 Docker 選項<br>\\n![[dot_net_6_docker_4.jpg]]<br>\\n專案建立之後進去看 <code>Dockerfile</code> 的內容，可以看到使用的映像檔是 aspnet<br>\\n![[dot_net_6_docker_5.jpg]]</p>","autoDesc":true}');export{A as comp,b as data};
